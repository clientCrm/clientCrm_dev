<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="zkz.kehu.mapper.ProductMapper">

    <!--查询所有产品显示到表格中-->
    <select id="queryProducts" resultType="zkz.kehu.vo.ProductVo">
select * from (SELECT
	pu.*, crmu.realname as charge_man
FROM
	(
	SELECT
		p.*,
		cu.realname AS create_man
	FROM
		( SELECT bcp.*, bpc.NAME FROM b_crm_product bcp LEFT JOIN b_crm_product_category bpc ON bcp.category_id = bpc.category_id ) p
	LEFT JOIN crm_user cu ON p.create_user_id = cu.user_id
	) pu left join crm_user crmu on pu.charge_user_id = crmu.user_id) last
    </select>

    <select id="queryUpProducts" resultType="zkz.kehu.vo.ProductVo">
SELECT
	*
FROM
	(
	SELECT
		pu.*,
		crmu.realname AS charge_man
	FROM
		(
		SELECT
			p.*,
			cu.realname AS create_man
		FROM
			( SELECT bcp.*, bpc.`name` FROM b_crm_product bcp LEFT JOIN b_crm_product_category bpc ON bcp.category_id = bpc.category_id ) p
			LEFT JOIN crm_user cu ON p.create_user_id = cu.user_id
		WHERE
			p.`status` = 1
		) pu
	LEFT JOIN crm_user crmu ON pu.charge_user_id = crmu.user_id
	) last
    </select>
</mapper>
